# 行程 (Process)
<br>

## 行程定義

可進行運算的基本單元，又稱行程映像 (Process Image)

||最大|
|:-:|:-:|
|堆疊||
|↑↓||
|堆積||
|資料區||
|本文區(程式碼)||
||0|

## 行程控制區塊 (Process Control Block，PCB)
紀錄行程切換所需資料；在多工環境下，OS 需做行程切換，讓多個工作共享CPU資源；
行程切換須同步切換PCB之內文資料，AKA內文切換 ==(Content Switch)==

1. 行程狀態：新建→備妥→執行→暫停→結束
2. CPU暫存器：稱內文資料 (Context)，如程式計數器、累加器、記憶體管理相關暫存器
3. 排成法則資訊 (行程優先權)；I/O 狀態資訊&會計資訊 (CPU已使用時間、帳號、PID)

## 行程建立
1. 指定唯一行程識別碼 (PID)
2. 分配空間 (大小由行程空間決定)
3. PCB初始化
4. 放置於適當佇列

## 父行程與子行程
一行程可以產生另一行程

## 行程與程式
* 行程：主記憶體內運算單元，指令執行，動態變化
* 程式：輔助記憶體內可執行檔，靜態個體，被動載入

# 行程執行
佇列與排成器
## 佇列
1. 工作佇列：新建行程先放工作佇列，等候分配記憶體
2. 備妥佇列：已載入主記憶體內的行程，先放備妥佇列，等候分配CPU時間，方可執行
3. 等待佇列：等待事件執行的行程，放置於等待佇列，以下 2種
	1. 等待過程，行程仍在主記憶體內，稱懸置佇列
	2. OS 因系統因素，將行程置換到硬碟，稱暫停佇列；
		1. 硬碟中，等待事件的行程放置在懸置—暫停佇列；
		2. 硬碟中，事件結束，等候重新載入主記憶體內執行的行程放置在備妥—暫停佇列

## 排程器
決定系統多工處理程度，有 I/O 排程器，負責處理行程的 I/O 需求
1. 短程排程：決定下一個取得CPU時間的行程，CPU分配，執行頻率高，==必定存在==
2. 長程排程：決定要啟動或終止的程式，執行頻率低，可有可無
3. 中程排程：負責行程在主記憶體與硬碟間的置換，執行頻率中

# 切換時機
1. 來自外部，稱==中斷==，如 I/O 動作完成、行程分配時間已到
2. 來自內部，如 指令發生錯誤

# 切換方式
1. 做內文切換 (Context Switch)，負擔重
2. 作模式切換，負擔輕

# 選擇模式
1. 不可搶先：非優先權式多工，執行中的行程持續執行，直到主動交出控制權
2. 可搶先：優先權式多工，執行中的行程可中斷，避免佔用過長CPU時間，需做內文切換，負擔重，但可大量減輕記憶體負擔

[回到索引]((%E4%BD%9C%E6%A5%AD%E7%B3%BB%E7%B5%B1%E7%B4%A2%E5%BC%95))